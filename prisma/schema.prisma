// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL") // uses connection pooling
  directUrl = env("POSTGRES_URL_NON_POOLING") // uses a direct connection
}

model Ubicacion {
  id            String      @id @default(uuid())
  calle         String
  numero        String
  codigo_postal String
  ciudad        String
  provincia     String
  paciente      Paciente?
  secretaria    Secretaria?
  medico        Medico?
}

model Secretaria {
  usuario         Usuario   @relation(fields: [usuario_id], references: [id])
  usuario_id      String    @id
  numero_telefono String
  ubicacion       Ubicacion @relation(fields: [ubicacion_id], references: [id])
  ubicacion_id    String    @unique
}

model Medico {
  usuario          Usuario           @relation(fields: [usuario_id], references: [id])
  usuario_id       String            @id
  tipo_matricula   TipoMatriculaEnum
  numero_matricula String            @unique
  numero_telefono  String
  ubicacion        Ubicacion         @relation(fields: [ubicacion_id], references: [id])
  ubicacion_id     String            @unique
  especialidad     Especialidad      @relation(fields: [especialidad_id], references: [id]) // Relaci√≥n con Especialidad
  especialidad_id  String
  descripcion      String?
}

model Paciente {
  usuario             Usuario     @relation(fields: [usuario_id], references: [id])
  usuario_id          String      @id
  fecha_nacimiento    DateTime
  lugar_nacimiento    String
  contacto_emergencia String
  numero_telefono     String
  ubicacion           Ubicacion   @relation(fields: [ubicacion_id], references: [id])
  ubicacion_id        String      @unique
  obra_social         ObraSocial  @relation(fields: [obra_social_id], references: [id])
  obra_social_id      String
  ficha_medica        FichaMedica @relation(fields: [ficha_medica_id], references: [id])
  ficha_medica_id     String      @unique
}

model Admin {
  usuario    Usuario @relation(fields: [usuario_id], references: [id])
  usuario_id String  @id
}

model Usuario {
  id                 String            @id @default(uuid())
  tipo_documento     TipoDocumentoEnum
  numero_documento   String            @unique
  nombre             String
  apellido           String
  correo_electronico String
  contrasena         String
  secretaria         Secretaria?
  medico             Medico?
  paciente           Paciente?
  admin              Admin?
}

enum TipoDocumentoEnum {
  CEDULA_IDENTIDAD
  DOCUMENTO_NACIONAL_IDENTIDAD
  LIBRETA_CIVICA
  LIBRETA_ENROLAMIENTO
  PASAPORTE
}

model FichaMedica {
  id                     String    @id @default(uuid())
  paciente               Paciente?
  alergias               String
  diagnostico            String
  tratamientos           String
  medicamentos_recetados String
}

enum TipoMatriculaEnum {
  nacional
  provincial
}

model Especialidad {
  id     String   @id @default(uuid())
  nombre String   @unique
  medico Medico[]
}

model ObraSocial {
  id       String     @id @default(uuid())
  nombre   String     @unique
  paciente Paciente[]
}
